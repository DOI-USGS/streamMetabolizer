<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="streamMetabolizer">
<title>Quickstart • streamMetabolizer</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quickstart">
<meta property="og:description" content="streamMetabolizer">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">streamMetabolizer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data_prep.html">Data Preparation</a>
    <a class="dropdown-item" href="../articles/get_started.html">Quickstart</a>
    <a class="dropdown-item" href="../articles/gpp_er_eqs.html">GPP and ER Equations</a>
    <a class="dropdown-item" href="../articles/installation.html">Installation</a>
    <a class="dropdown-item" href="../articles/model_structures.html">Model Structures</a>
    <a class="dropdown-item" href="../articles/models_bayes.html">Bayesian Models</a>
    <a class="dropdown-item" href="../articles/models_mle.html">MLE Models</a>
    <a class="dropdown-item" href="../articles/ode_methods.html">ODE Methods</a>
    <a class="dropdown-item" href="../articles/simulations.html">Simulations</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/USGS-R/streamMetabolizer/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Quickstart</h1>
                        <h4 data-toc-skip class="author">Alison
Appling</h4>
            
            <h4 data-toc-skip class="date">2023-07-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/USGS-R/streamMetabolizer/blob/HEAD/vignettes/get_started.Rmd" class="external-link"><code>vignettes/get_started.Rmd</code></a></small>
      <div class="d-none name"><code>get_started.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This tutorial shows how to estimate stream metabolism using
<code>streamMetabolizer</code> and some example data supplied by Bob
Hall for French Creek in Laramie, WY.</p>
<p>There are four steps to fitting a metabolism model in
<code>streamMetabolizer</code>.</p>
<ol style="list-style-type: decimal">
<li>Prepare and inspect the input data.</li>
<li>Choose a model configuration appropriate to your data.</li>
<li>Fit the model.</li>
<li>Inspect the output.</li>
</ol>
<p>In this tutorial we will demonstrate these steps for a single model
structure and a single set of specifications, but you should also
consider other structures and should always tailor the specifications to
your dataset and site knowledge. For more details, see:</p>
<ul>
<li><a href="models_bayes.html">Bayesian Models</a></li>
<li><a href="models_mle.html">MLE Models</a></li>
<li><a href="models_other.html">Model Types</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="preliminaries">Preliminaries<a class="anchor" aria-label="anchor" href="#preliminaries"></a>
</h2>
<p>If you haven’t already installed the package, see the <a href="installation.html">Installation</a> tutorial.</p>
<p>Next load the R libraries. Only <code>streamMetabolizer</code> is
required to run models, but we’ll also be using <code>dplyr</code> to
inspect the results.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/USGS-R/streamMetabolizer" class="external-link">streamMetabolizer</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="preparing-the-input-data">1. Preparing the input data<a class="anchor" aria-label="anchor" href="#preparing-the-input-data"></a>
</h2>
<p>Load a small example dataset from the package (data are from French
Creek in Laramie, WY, courtesy of Bob Hall). We’ll use the
<code>streamMetabolizer</code> standard in defining our day to run from
4 am (<code>day_start=4</code>) to 4 am (<code>day_end=28</code>).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_metab.html">data_metab</a></span><span class="op">(</span>num_days<span class="op">=</span><span class="st">'3'</span>, res<span class="op">=</span><span class="st">'15'</span>, day_start<span class="op">=</span><span class="fl">4</span>, day_end<span class="op">=</span><span class="fl">28</span><span class="op">)</span></span></code></pre></div>
<p>See the <code><a href="../reference/metab.html">?metab</a></code> help document and the <a href="data_prep.html">Data Preparation</a> tutorial for more on how to
properly format and inspect a dataset.</p>
</div>
<div class="section level2">
<h2 id="configuring-the-model">2. Configuring the model<a class="anchor" aria-label="anchor" href="#configuring-the-model"></a>
</h2>
<p>There are two steps to configuring a metabolism model in
<code>streamMetabolizer</code>.</p>
<ol style="list-style-type: lower-alpha">
<li>Identify the name of the model structure you want using
<code><a href="../reference/mm_name.html">mm_name()</a></code>.</li>
<li>Set the specifications for the model using defaults
from<code><a href="../reference/specs.html">specs()</a></code> as a starting point.</li>
</ol>
<div class="section level3">
<h3 id="a--choose-a-model-structure">2a. Choose a model structure<a class="anchor" aria-label="anchor" href="#a--choose-a-model-structure"></a>
</h3>
<p>For this example, we will specify a Bayesian model with both
observation error and process error. We won’t pool K600 here because we
don’t have many days of data, but pooling is one feature that makes
Bayesian models better than MLE models in general. Another great feature
of Bayesian models is that they produce more accurate and nuanced
confidence intervals.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bayes_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mm_name.html">mm_name</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">'bayes'</span>, pool_K600<span class="op">=</span><span class="st">'none'</span>, err_obs_iid<span class="op">=</span><span class="cn">TRUE</span>, err_proc_iid<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">bayes_name</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "b_np_oipi_tr_plrckm.stan"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="b--set-the-specifications">2b. Set the specifications<a class="anchor" aria-label="anchor" href="#b--set-the-specifications"></a>
</h3>
<p>We now pass the model name to <code><a href="../reference/specs.html">specs()</a></code> to get a list of
default specifications for this model.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bayes_specs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/specs.html">specs</a></span><span class="op">(</span><span class="va">bayes_name</span><span class="op">)</span></span>
<span><span class="va">bayes_specs</span></span></code></pre></div>
<pre><code><span><span class="co">## Model specifications:</span></span>
<span><span class="co">##   model_name               b_np_oipi_tr_plrckm.stan                             </span></span>
<span><span class="co">##   engine                   stan                                                 </span></span>
<span><span class="co">##   split_dates              FALSE                                                </span></span>
<span><span class="co">##   keep_mcmcs               TRUE                                                 </span></span>
<span><span class="co">##   keep_mcmc_data           TRUE                                                 </span></span>
<span><span class="co">##   day_start                4                                                    </span></span>
<span><span class="co">##   day_end                  28                                                   </span></span>
<span><span class="co">##   day_tests                full_day, even_timesteps, complete_data, pos_disch...</span></span>
<span><span class="co">##   required_timestep        NA                                                   </span></span>
<span><span class="co">##   GPP_daily_mu             3.1                                                  </span></span>
<span><span class="co">##   GPP_daily_lower          -Inf                                                 </span></span>
<span><span class="co">##   GPP_daily_sigma          6                                                    </span></span>
<span><span class="co">##   ER_daily_mu              -7.1                                                 </span></span>
<span><span class="co">##   ER_daily_upper           Inf                                                  </span></span>
<span><span class="co">##   ER_daily_sigma           7.1                                                  </span></span>
<span><span class="co">##   K600_daily_meanlog       2.484906649788                                       </span></span>
<span><span class="co">##   K600_daily_sdlog         1                                                    </span></span>
<span><span class="co">##   err_obs_iid_sigma_scale  0.03                                                 </span></span>
<span><span class="co">##   err_proc_iid_sigma_scale 5                                                    </span></span>
<span><span class="co">##   params_in                GPP_daily_mu, GPP_daily_lower, GPP_daily_sigma, ER...</span></span>
<span><span class="co">##   params_out               GPP, ER, DO_R2, GPP_daily, ER_daily, K600_daily, e...</span></span>
<span><span class="co">##   n_chains                 4                                                    </span></span>
<span><span class="co">##   n_cores                  4                                                    </span></span>
<span><span class="co">##   burnin_steps             500                                                  </span></span>
<span><span class="co">##   saved_steps              500                                                  </span></span>
<span><span class="co">##   thin_steps               1                                                    </span></span>
<span><span class="co">##   verbose                  FALSE</span></span></code></pre>
<p>At this point we can alter some of the specifications if desired.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># one way to alter specifications: call specs() again</span></span>
<span><span class="va">bayes_specs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/specs.html">specs</a></span><span class="op">(</span><span class="va">bayes_name</span>, burnin_steps<span class="op">=</span><span class="fl">100</span>, saved_steps<span class="op">=</span><span class="fl">200</span>, n_cores<span class="op">=</span><span class="fl">1</span>, GPP_daily_mu<span class="op">=</span><span class="fl">3</span>, GPP_daily_sigma<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># another way: use revise()</span></span>
<span><span class="va">bayes_specs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/revise.html">revise</a></span><span class="op">(</span><span class="va">bayes_specs</span>, burnin_steps<span class="op">=</span><span class="fl">100</span>, saved_steps<span class="op">=</span><span class="fl">200</span>, n_cores<span class="op">=</span><span class="fl">1</span>, GPP_daily_mu<span class="op">=</span><span class="fl">3</span>, GPP_daily_sigma<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Here I’ve used a very small number of <code>burnin_steps</code> and
<code>saved_steps</code> because I don’t want to wait long for the
vignette to run. When you run your own models, you should bump those
numbers up substantially (to several thousand or so, depending on
exactly which model you’re using.)</p>
<p>Other Bayesian model specifications will also need your close
attention when you’re running your own models. See <a href="models_bayes.html">Bayesian Models</a> for details.</p>
</div>
</div>
<div class="section level2">
<h2 id="fitting-the-model">3. Fitting the model<a class="anchor" aria-label="anchor" href="#fitting-the-model"></a>
</h2>
<p>Once a model has been configured, you can fit the model to data with
<code><a href="../reference/metab.html">metab()</a></code>. Bayesian models take a while to run, so be
patient. Or switch to an MLE model if you can afford to sacrifice some
accuracy for speed. (This small example usually takes about 30 seconds
on my computer.)</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/metab.html">metab</a></span><span class="op">(</span><span class="va">bayes_specs</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="inspecting-the-model">4. Inspecting the model<a class="anchor" aria-label="anchor" href="#inspecting-the-model"></a>
</h2>
<p>Once you’ve fit a model, you can inspect the output with functions
including <code><a href="../reference/predict_metab.html">predict_metab()</a></code> and
<code><a href="../reference/plot_metab_preds.html">plot_metab_preds()</a></code>, <code><a href="../reference/predict_DO.html">predict_DO()</a></code> and
<code><a href="../reference/plot_DO_preds.html">plot_DO_preds()</a></code>, <code><a href="../reference/get_params.html">get_params()</a></code>, and
<code><a href="../reference/get_fit.html">get_fit()</a></code>.</p>
<p>Start by simply printing the model to the console.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mm</span></span></code></pre></div>
<pre><code><span><span class="co">## metab_model of type metab_bayes </span></span>
<span><span class="co">## streamMetabolizer version 0.12.1 </span></span>
<span><span class="co">## Specifications:</span></span>
<span><span class="co">##   model_name               b_np_oipi_tr_plrckm.stan                             </span></span>
<span><span class="co">##   engine                   stan                                                 </span></span>
<span><span class="co">##   split_dates              FALSE                                                </span></span>
<span><span class="co">##   keep_mcmcs               TRUE                                                 </span></span>
<span><span class="co">##   keep_mcmc_data           TRUE                                                 </span></span>
<span><span class="co">##   day_start                4                                                    </span></span>
<span><span class="co">##   day_end                  28                                                   </span></span>
<span><span class="co">##   day_tests                full_day, even_timesteps, complete_data, pos_disch...</span></span>
<span><span class="co">##   required_timestep        NA                                                   </span></span>
<span><span class="co">##   GPP_daily_mu             3                                                    </span></span>
<span><span class="co">##   GPP_daily_lower          -Inf                                                 </span></span>
<span><span class="co">##   GPP_daily_sigma          2                                                    </span></span>
<span><span class="co">##   ER_daily_mu              -7.1                                                 </span></span>
<span><span class="co">##   ER_daily_upper           Inf                                                  </span></span>
<span><span class="co">##   ER_daily_sigma           7.1                                                  </span></span>
<span><span class="co">##   K600_daily_meanlog       2.484906649788                                       </span></span>
<span><span class="co">##   K600_daily_sdlog         1                                                    </span></span>
<span><span class="co">##   err_obs_iid_sigma_scale  0.03                                                 </span></span>
<span><span class="co">##   err_proc_iid_sigma_scale 5                                                    </span></span>
<span><span class="co">##   params_in                GPP_daily_mu, GPP_daily_lower, GPP_daily_sigma, ER...</span></span>
<span><span class="co">##   params_out               GPP, ER, DO_R2, GPP_daily, ER_daily, K600_daily, e...</span></span>
<span><span class="co">##   n_chains                 4                                                    </span></span>
<span><span class="co">##   n_cores                  1                                                    </span></span>
<span><span class="co">##   burnin_steps             100                                                  </span></span>
<span><span class="co">##   saved_steps              200                                                  </span></span>
<span><span class="co">##   thin_steps               1                                                    </span></span>
<span><span class="co">##   verbose                  FALSE                                                </span></span>
<span><span class="co">##   model_path               /private/var/folders/_0/fbg0ffkj6z3fb_7jvm8wg86s81...</span></span>
<span><span class="co">## Fitting time: 19.66 secs elapsed</span></span>
<span><span class="co">## Parameters (3 dates):</span></span>
<span><span class="co">##         date GPP.daily GPP.daily.lower GPP.daily.upper   ER.daily</span></span>
<span><span class="co">## 1 2012-09-18 5.573649       -0.1410918        7.259060 -4.267688 </span></span>
<span><span class="co">## 2 2012-09-19 3.191503       -0.2813929       10.037324 -2.454561 </span></span>
<span><span class="co">## 3 2012-09-20 3.806921       -0.2556618        7.123052 -2.693674 </span></span>
<span><span class="co">##   ER.daily.lower ER.daily.upper K600.daily K600.daily.lower K600.daily.upper</span></span>
<span><span class="co">## 1      -6.028402      0.3099591  56.90414         2.2314706         73.82301</span></span>
<span><span class="co">## 2      -7.968363      0.5319808  31.84568         1.3156141         92.78600</span></span>
<span><span class="co">## 3      -5.362254      0.4827049  39.74744         0.7490546         72.03294</span></span>
<span><span class="co">##   msgs.fit</span></span>
<span><span class="co">## 1  w      </span></span>
<span><span class="co">## 2  w      </span></span>
<span><span class="co">## 3  w      </span></span>
<span><span class="co">## Fitting warnings:</span></span>
<span><span class="co">##   There were 4 chains where the estimated Bayesian Fraction of Missing Information was low. See</span></span>
<span><span class="co">## https://mc-stan.org/misc/warnings.html#bfmi-low</span></span>
<span><span class="co">##   Examine the pairs() plot to diagnose sampling problems</span></span>
<span><span class="co">##   The largest R-hat is 3.48, indicating chains have not mixed.</span></span>
<span><span class="co">## Running the chains for more iterations may help. See</span></span>
<span><span class="co">## https://mc-stan.org/misc/warnings.html#r-hat</span></span>
<span><span class="co">##   Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span></span>
<span><span class="co">## Running the chains for more iterations may help. See</span></span>
<span><span class="co">## https://mc-stan.org/misc/warnings.html#bulk-ess</span></span>
<span><span class="co">##   Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span></span>
<span><span class="co">## Running the chains for more iterations may help. See</span></span>
<span><span class="co">## https://mc-stan.org/misc/warnings.html#tail-ess</span></span>
<span><span class="co">##   3 dates: overall warnings</span></span>
<span><span class="co">## Predictions (3 dates):</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 9</span></span></span>
<span><span class="co">##   date         GPP GPP.lower GPP.upper    ER ER.lower ER.upper msgs.fit </span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 2012-09-18  5.57    -<span style="color: #BB0000;">0.141</span>      7.26 -<span style="color: #BB0000;">4.27</span>    -<span style="color: #BB0000;">6.03</span>    0.310 <span style="color: #949494;">"</span>w      <span style="color: #949494;">"</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 2012-09-19  3.19    -<span style="color: #BB0000;">0.281</span>     10.0  -<span style="color: #BB0000;">2.45</span>    -<span style="color: #BB0000;">7.97</span>    0.532 <span style="color: #949494;">"</span>w      <span style="color: #949494;">"</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 2012-09-20  3.81    -<span style="color: #BB0000;">0.256</span>      7.12 -<span style="color: #BB0000;">2.69</span>    -<span style="color: #BB0000;">5.36</span>    0.483 <span style="color: #949494;">"</span>w      <span style="color: #949494;">"</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: msgs.pred &lt;chr&gt;</span></span></span></code></pre>
<p>Here are the daily metabolism predictions from the model:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/predict_metab.html">predict_metab</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 10</span></span></span>
<span><span class="co">##   date         GPP GPP.lower GPP.upper    ER ER.lower ER.upper msgs.fit warnings</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 2012-09-18  5.57    -<span style="color: #BB0000;">0.141</span>      7.26 -<span style="color: #BB0000;">4.27</span>    -<span style="color: #BB0000;">6.03</span>    0.310 <span style="color: #949494;">"</span>w     … <span style="color: #949494;">""</span>      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 2012-09-19  3.19    -<span style="color: #BB0000;">0.281</span>     10.0  -<span style="color: #BB0000;">2.45</span>    -<span style="color: #BB0000;">7.97</span>    0.532 <span style="color: #949494;">"</span>w     … <span style="color: #949494;">""</span>      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 2012-09-20  3.81    -<span style="color: #BB0000;">0.256</span>      7.12 -<span style="color: #BB0000;">2.69</span>    -<span style="color: #BB0000;">5.36</span>    0.483 <span style="color: #949494;">"</span>w     … <span style="color: #949494;">""</span>      </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: errors &lt;chr&gt;</span></span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_metab_preds.html">plot_metab_preds</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span></span></code></pre></div>
<p><img src="get_started_files/figure-html/bayes_pred_fig-1.png" width="480"></p>
<p>You can inspect more of the fitted daily parameters, including K600,
with <code><a href="../reference/get_params.html">get_params()</a></code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_params.html">get_params</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 9</span></span></span>
<span><span class="co">##   date       GPP.daily GPP.daily.sd ER.daily ER.daily.sd K600.daily</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 2012-09-18      4.07         2.69    -<span style="color: #BB0000;">3.20</span>        2.18       42.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 2012-09-19      4.08         3.31    -<span style="color: #BB0000;">3.22</span>        2.69       39.7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 2012-09-20      3.01         1.99    -<span style="color: #BB0000;">2.14</span>        1.52       32.2</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 3 more variables: K600.daily.sd &lt;dbl&gt;, warnings &lt;chr&gt;, errors &lt;chr&gt;</span></span></span></code></pre>
<p>Here are the first few dissolved oxygen predictions from the model
(<code>DO.mod</code>). They are returned along with the input data for
convenience.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/predict_DO.html">predict_DO</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>    date          solar.time DO.obs   DO.sat depth temp.water light</code></pre>
<p>1 2012-09-18 2012-09-18 04:05:58 8.41 9.083329 0.16 3.60 0 2
2012-09-18 2012-09-18 04:20:58 8.42 9.093063 0.16 3.56 0 3 2012-09-18
2012-09-18 04:35:58 8.42 9.105254 0.16 3.51 0 4 2012-09-18 2012-09-18
04:50:58 8.43 9.112582 0.16 3.48 0 5 2012-09-18 2012-09-18 05:05:58 8.45
9.127267 0.16 3.42 0 6 2012-09-18 2012-09-18 05:20:58 8.46 9.137079 0.16
3.38 0 DO.mod 1 8.410000 2 8.406979 3 8.407403 4 8.410073 5 8.414697 6
8.421057</p>
<p>And here are the dissolved oxygen predictions in a figure:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_DO_preds.html">plot_DO_preds</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span></span></code></pre></div>
<p><img src="get_started_files/figure-html/bayes_pdo_fig-1.png" width="480"></p>
<p>For Bayesian models only, you can dig even deeper using
<code>get_mcmc</code>, which returns a <code>stanfit</code> object that
can be inspected using the <code>rstan</code> package. (These traceplots
are pretty bad because we used so few MCMC iterations. You should strive
for better in your final models.)</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mcmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_mcmc.html">get_mcmc</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span></span>
<span><span class="fu">rstan</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstan/reference/stanfit-method-traceplot.html" class="external-link">traceplot</a></span><span class="op">(</span><span class="va">mcmc</span>, pars<span class="op">=</span><span class="st">'K600_daily'</span>, nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="get_started_files/figure-html/unnamed-chunk-3-1.png" width="480"></p>
<p>The <code><a href="../reference/get_fit.html">get_fit()</a></code> function returns a list of data.frames,
one per temporal resolution, containing all fitted values and details
about their distributions and convergence. Here are just the overall
metrics of model convergence (<code>Rhat</code>s, or potential scale
reduction statistics; see Gelman and Rubin 1992 or Brooks and Gelman
1998):</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_fit.html">get_fit</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span><span class="op">$</span><span class="va">overall</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">ends_with</a></span><span class="op">(</span><span class="st">'Rhat'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">##   err_obs_iid_sigma_Rhat err_proc_iid_sigma_Rhat lp___Rhat</span></span>
<span><span class="co">##                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>                   2.77                    2.79      4.16</span></span></code></pre>
<p>And here is a list of all column names available through
<code><a href="../reference/get_fit.html">get_fit()</a></code>:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_fit.html">get_fit</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $daily</span></span>
<span><span class="co">##  [1] "date"               "GPP_mean"           "GPP_se_mean"       </span></span>
<span><span class="co">##  [4] "GPP_sd"             "GPP_2.5pct"         "GPP_25pct"         </span></span>
<span><span class="co">##  [7] "GPP_50pct"          "GPP_75pct"          "GPP_97.5pct"       </span></span>
<span><span class="co">## [10] "GPP_n_eff"          "GPP_Rhat"           "ER_mean"           </span></span>
<span><span class="co">## [13] "ER_se_mean"         "ER_sd"              "ER_2.5pct"         </span></span>
<span><span class="co">## [16] "ER_25pct"           "ER_50pct"           "ER_75pct"          </span></span>
<span><span class="co">## [19] "ER_97.5pct"         "ER_n_eff"           "ER_Rhat"           </span></span>
<span><span class="co">## [22] "DO_R2_mean"         "DO_R2_se_mean"      "DO_R2_sd"          </span></span>
<span><span class="co">## [25] "DO_R2_2.5pct"       "DO_R2_25pct"        "DO_R2_50pct"       </span></span>
<span><span class="co">## [28] "DO_R2_75pct"        "DO_R2_97.5pct"      "DO_R2_n_eff"       </span></span>
<span><span class="co">## [31] "DO_R2_Rhat"         "GPP_daily_mean"     "GPP_daily_se_mean" </span></span>
<span><span class="co">## [34] "GPP_daily_sd"       "GPP_daily_2.5pct"   "GPP_daily_25pct"   </span></span>
<span><span class="co">## [37] "GPP_daily_50pct"    "GPP_daily_75pct"    "GPP_daily_97.5pct" </span></span>
<span><span class="co">## [40] "GPP_daily_n_eff"    "GPP_daily_Rhat"     "ER_daily_mean"     </span></span>
<span><span class="co">## [43] "ER_daily_se_mean"   "ER_daily_sd"        "ER_daily_2.5pct"   </span></span>
<span><span class="co">## [46] "ER_daily_25pct"     "ER_daily_50pct"     "ER_daily_75pct"    </span></span>
<span><span class="co">## [49] "ER_daily_97.5pct"   "ER_daily_n_eff"     "ER_daily_Rhat"     </span></span>
<span><span class="co">## [52] "K600_daily_mean"    "K600_daily_se_mean" "K600_daily_sd"     </span></span>
<span><span class="co">## [55] "K600_daily_2.5pct"  "K600_daily_25pct"   "K600_daily_50pct"  </span></span>
<span><span class="co">## [58] "K600_daily_75pct"   "K600_daily_97.5pct" "K600_daily_n_eff"  </span></span>
<span><span class="co">## [61] "K600_daily_Rhat"    "valid_day"          "warnings"          </span></span>
<span><span class="co">## [64] "errors"            </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $inst</span></span>
<span><span class="co">##  [1] "date"                 "solar.time"           "err_obs_iid_mean"    </span></span>
<span><span class="co">##  [4] "err_obs_iid_se_mean"  "err_obs_iid_sd"       "err_obs_iid_2.5pct"  </span></span>
<span><span class="co">##  [7] "err_obs_iid_25pct"    "err_obs_iid_50pct"    "err_obs_iid_75pct"   </span></span>
<span><span class="co">## [10] "err_obs_iid_97.5pct"  "err_obs_iid_n_eff"    "err_obs_iid_Rhat"    </span></span>
<span><span class="co">## [13] "err_proc_iid_mean"    "err_proc_iid_se_mean" "err_proc_iid_sd"     </span></span>
<span><span class="co">## [16] "err_proc_iid_2.5pct"  "err_proc_iid_25pct"   "err_proc_iid_50pct"  </span></span>
<span><span class="co">## [19] "err_proc_iid_75pct"   "err_proc_iid_97.5pct" "err_proc_iid_n_eff"  </span></span>
<span><span class="co">## [22] "err_proc_iid_Rhat"   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $overall</span></span>
<span><span class="co">##  [1] "date_index"                 "time_index"                </span></span>
<span><span class="co">##  [3] "index"                      "err_obs_iid_sigma_mean"    </span></span>
<span><span class="co">##  [5] "err_obs_iid_sigma_se_mean"  "err_obs_iid_sigma_sd"      </span></span>
<span><span class="co">##  [7] "err_obs_iid_sigma_2.5pct"   "err_obs_iid_sigma_25pct"   </span></span>
<span><span class="co">##  [9] "err_obs_iid_sigma_50pct"    "err_obs_iid_sigma_75pct"   </span></span>
<span><span class="co">## [11] "err_obs_iid_sigma_97.5pct"  "err_obs_iid_sigma_n_eff"   </span></span>
<span><span class="co">## [13] "err_obs_iid_sigma_Rhat"     "err_proc_iid_sigma_mean"   </span></span>
<span><span class="co">## [15] "err_proc_iid_sigma_se_mean" "err_proc_iid_sigma_sd"     </span></span>
<span><span class="co">## [17] "err_proc_iid_sigma_2.5pct"  "err_proc_iid_sigma_25pct"  </span></span>
<span><span class="co">## [19] "err_proc_iid_sigma_50pct"   "err_proc_iid_sigma_75pct"  </span></span>
<span><span class="co">## [21] "err_proc_iid_sigma_97.5pct" "err_proc_iid_sigma_n_eff"  </span></span>
<span><span class="co">## [23] "err_proc_iid_sigma_Rhat"    "lp___mean"                 </span></span>
<span><span class="co">## [25] "lp___se_mean"               "lp___sd"                   </span></span>
<span><span class="co">## [27] "lp___2.5pct"                "lp___25pct"                </span></span>
<span><span class="co">## [29] "lp___50pct"                 "lp___75pct"                </span></span>
<span><span class="co">## [31] "lp___97.5pct"               "lp___n_eff"                </span></span>
<span><span class="co">## [33] "lp___Rhat"                 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $warnings</span></span>
<span><span class="co">## NULL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $errors</span></span>
<span><span class="co">## NULL</span></span></code></pre>
<p>You’re on your way!</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Alison P. Appling, Robert O. Hall, Maite Arroita, Charles B. Yackulic.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
