% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/metab.R
\name{metab}
\alias{metab}
\title{Fit a metabolism model to data}
\usage{
metab(specs = specs(mm_name()), data = v(mm_data(NULL)),
  data_daily = v(mm_data(NULL)), info = NULL)
}
\arguments{
\item{specs}{a list of model specifications and parameters for a model. 
Although this may be specified manually (it's just a list), it is easier
and safer to use \code{\link{specs}} to generate the list, because the set
of required parameters and their defaults depends on the model given in the
\code{model_name} argument to \code{specs}. The help file for 
\code{\link{specs}} lists the necessary parameters, describes them in 
detail, and gives default values.}

\item{data}{data.frame of input data at the temporal resolution of raw 
observations (unit-value). Columns must have the same names, units, and 
format as the default. See the \strong{'Formatting \code{data}'} section 
below for a full description.}

\item{data_daily}{data.frame containing inputs with a daily timestep. See the
\strong{'Formatting \code{data_daily}'} section below for a full 
description.}

\item{info}{any information, in any format, that you would like to store 
within the metab_model object}
}
\value{
An object inheriting from metab_model and containing the fitted 
  model. This object can be inspected with the functions in the 
  \code{\link{metab_model_interface}}.
}
\description{
Runs the metabolism model specified by the \code{specs} argument. Returns a 
fitted model.
}
\section{Formatting \code{data}}{

Unit-value model inputs passed via the \code{data} argument should
be formatted as a data.frame with column names and values that
depend on the model \code{type}, as follows.
(If all columns are optional, \code{data} may equal \code{NULL}.)

\describe{
  \item{\code{mle} or \code{night}}{
    \tabular{llll}{
      \strong{colname} \tab \strong{class} \tab \strong{units} \tab \strong{need}\cr
      solar.time        \tab POSIXct,POSIXt  \tab                 \tab required      \cr
      DO.obs            \tab numeric         \tab mgO2 L^-1       \tab required      \cr
      DO.sat            \tab numeric         \tab mgO2 L^-1       \tab required      \cr
      depth             \tab numeric         \tab m               \tab required      \cr
      temp.water        \tab numeric         \tab degC            \tab required      \cr
      light             \tab numeric         \tab umol m^-2 s^-1  \tab required      
    }
    
    \strong{Example}:
    \tabular{lrrrrr}{
      \code{solar.time         } \tab \code{DO.obs} \tab \code{DO.sat} \tab \code{depth} \tab \code{temp.water} \tab \code{light}\cr
      \code{2050-03-14 15:10:00} \tab \code{10.1  } \tab \code{14.2  } \tab \code{0.5  } \tab \code{21.8      } \tab \code{300.9}
    }
  }
  \item{\code{bayes}}{
    \tabular{llll}{
      \strong{colname} \tab \strong{class} \tab \strong{units} \tab \strong{need}\cr
      solar.time        \tab POSIXct,POSIXt  \tab                 \tab required      \cr
      DO.obs            \tab numeric         \tab mgO2 L^-1       \tab required      \cr
      DO.sat            \tab numeric         \tab mgO2 L^-1       \tab required      \cr
      depth             \tab numeric         \tab m               \tab required      \cr
      temp.water        \tab numeric         \tab degC            \tab required      \cr
      light             \tab numeric         \tab umol m^-2 s^-1  \tab required      \cr
      discharge         \tab numeric         \tab m^3 s^-1        \tab optional      
    }
    
    \strong{Example}:
    \tabular{lrrrrrr}{
      \code{solar.time         } \tab \code{DO.obs} \tab \code{DO.sat} \tab \code{depth} \tab \code{temp.water} \tab \code{light} \tab \code{discharge}\cr
      \code{2050-03-14 15:10:00} \tab \code{10.1  } \tab \code{14.2  } \tab \code{0.5  } \tab \code{21.8      } \tab \code{300.9} \tab \code{9        }
    }
  }
  \item{\code{Kmodel}}{
    \tabular{llll}{
      \strong{colname} \tab \strong{class} \tab \strong{units} \tab \strong{need}\cr
      solar.time        \tab POSIXct,POSIXt  \tab                 \tab optional      \cr
      discharge         \tab numeric         \tab m^3 s^-1        \tab optional      \cr
      velocity          \tab numeric         \tab m s^-1          \tab optional      
    }
    
    \strong{Example}:
    \tabular{lrr}{
      \code{solar.time         } \tab \code{discharge} \tab \code{velocity}\cr
      \code{2050-03-14 15:10:00} \tab \code{9        } \tab \code{2       }
    }
  }
  \item{\code{sim}}{
    \tabular{llll}{
      \strong{colname} \tab \strong{class} \tab \strong{units} \tab \strong{need}\cr
      solar.time        \tab POSIXct,POSIXt  \tab                 \tab required      \cr
      DO.obs            \tab numeric         \tab mgO2 L^-1       \tab optional      \cr
      DO.sat            \tab numeric         \tab mgO2 L^-1       \tab required      \cr
      depth             \tab numeric         \tab m               \tab required      \cr
      temp.water        \tab numeric         \tab degC            \tab required      \cr
      light             \tab numeric         \tab umol m^-2 s^-1  \tab required      
    }
    
    \strong{Example}:
    \tabular{lrrrrr}{
      \code{solar.time         } \tab \code{DO.obs} \tab \code{DO.sat} \tab \code{depth} \tab \code{temp.water} \tab \code{light}\cr
      \code{2050-03-14 15:10:00} \tab \code{10.1  } \tab \code{14.2  } \tab \code{0.5  } \tab \code{21.8      } \tab \code{300.9}
    }
  }
}
}

\section{Formatting \code{data_daily}}{

Daily-value model inputs passed via the \code{data_daily} argument should
be formatted as a data.frame with column names and values that
depend on the model \code{type}, as follows.
(If all columns are optional, \code{data_daily} may equal \code{NULL}.)

\describe{
  \item{\code{night}}{
    \code{NULL}
  }
  \item{\code{mle}}{
    \tabular{llll}{
      \strong{colname} \tab \strong{class} \tab \strong{units} \tab \strong{need}\cr
      date              \tab Date            \tab                 \tab optional      \cr
      K600              \tab numeric         \tab d^-1            \tab optional      
    }
    
    \strong{Example}:
    \tabular{lr}{
      \code{date      } \tab \code{K600}\cr
      \code{2050-03-14} \tab \code{5   }
    }
  }
  \item{\code{bayes}}{
    \tabular{llll}{
      \strong{colname} \tab \strong{class} \tab \strong{units} \tab \strong{need}\cr
      date              \tab Date            \tab                 \tab optional      \cr
      discharge.daily   \tab numeric         \tab m^3 s^-1        \tab optional      
    }
    
    \strong{Example}:
    \tabular{lr}{
      \code{date      } \tab \code{discharge.daily}\cr
      \code{2050-03-14} \tab \code{9              }
    }
  }
  \item{\code{Kmodel}}{
    \tabular{llll}{
      \strong{colname} \tab \strong{class} \tab \strong{units} \tab \strong{need}\cr
      date              \tab Date            \tab                 \tab required      \cr
      K600              \tab numeric         \tab d^-1            \tab required      \cr
      K600.lower        \tab numeric         \tab d^-1            \tab optional      \cr
      K600.upper        \tab numeric         \tab d^-1            \tab optional      \cr
      discharge.daily   \tab numeric         \tab m^3 s^-1        \tab optional      \cr
      velocity.daily    \tab numeric         \tab m s^-1          \tab optional      
    }
    
    \strong{Example}:
    \tabular{lrrrrr}{
      \code{date      } \tab \code{K600} \tab \code{K600.lower} \tab \code{K600.upper} \tab \code{discharge.daily} \tab \code{velocity.daily}\cr
      \code{2050-03-14} \tab \code{5   } \tab \code{4.5       } \tab \code{5.6       } \tab \code{9              } \tab \code{2             }
    }
  }
  \item{\code{sim}}{
    \tabular{llll}{
      \strong{colname} \tab \strong{class} \tab \strong{units} \tab \strong{need}\cr
      date              \tab Date            \tab                 \tab required      \cr
      DO.mod.1          \tab numeric         \tab mgO2 L^-1       \tab optional      \cr
      GPP               \tab numeric         \tab gO2 d^-1 m^-2   \tab required      \cr
      ER                \tab numeric         \tab gO2 d^-1 m^-2   \tab required      \cr
      K600              \tab numeric         \tab d^-1            \tab required      
    }
    
    \strong{Example}:
    \tabular{lrrrr}{
      \code{date      } \tab \code{DO.mod.1} \tab \code{GPP} \tab \code{ER} \tab \code{K600}\cr
      \code{2050-03-14} \tab \code{7.5     } \tab \code{5  } \tab \code{5 } \tab \code{5   }
    }
  }
}
}
\examples{
dat <- data_metab(num_days='3')

# fit a basic MLE model
mm <- metab(specs(mm_name('mle')), data=dat, info='my info')
predict_metab(mm)
get_info(mm)
get_fitting_time(mm)

# with chaining & customization
library(dplyr)
mm <- mm_name('mle', ode_method='Euler') \%>\%
  specs(GPP_init=40) \%>\%
  metab(data=dat)
predict_metab(mm)
\dontrun{
plot_DO_preds(predict_DO(mm))
plot_DO_preds(predict_DO(mm), y_var='pctsat', style='dygraphs')
}
}
\author{
Alison Appling
}

